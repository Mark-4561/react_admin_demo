{"ast":null,"code":"import \"antd/es/card/style/css\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/table/style/css\";\nimport _Table from \"antd/es/table\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/space/style/css\";\nimport _Space from \"antd/es/space\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nvar _jsxFileName = \"D:\\\\Mark\\\\RA\\\\ws\\\\react-admin\\\\src\\\\pages\\\\category\\\\category.jsx\";\nimport React, { Component, useState } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { PlusOutlined } from '@ant-design/icons';\nimport LinkButton from '../../components/link-button';\nimport { reqCategorys, reqUpdateCategory, reqAddCategory } from '../../api';\nimport AddForm from './add';\nimport UpdateForm from './update';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Category extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      loading: false,\n      categorys: [],\n      subCategorys: [],\n      showStatus: 0,\n      parentId: \"0\",\n      parentName: \"\"\n    };\n\n    this.initCategory = () => {\n      this.columns = [{\n        title: '分类名称',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '操作',\n        dataIndex: '',\n        key: \"action\",\n        width: 200,\n        render: category => /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [/*#__PURE__*/_jsxDEV(LinkButton, {\n            onClick: () => {\n              this.category = category;\n              this.setState({\n                showStatus: 2\n              });\n            },\n            children: \"\\u4FEE\\u6539\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 25\n          }, this), \" \", this.state.parentId === \"0\" ? /*#__PURE__*/_jsxDEV(LinkButton, {\n            onClick: () => {\n              this.showSubCategory(category);\n            },\n            children: \"\\u67E5\\u770B\\u5B50\\u5206\\u7C7B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 46,\n            columnNumber: 29\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 21\n        }, this)\n      }];\n    };\n\n    this.getCategorys = async () => {\n      this.setState({\n        loading: true\n      });\n      const {\n        parentId\n      } = this.state;\n      const result = await reqCategorys(parentId);\n      this.setState({\n        loading: false\n      });\n\n      if (result.status === 0) {\n        const categorys = result.data;\n\n        if (parentId === \"0\") {\n          this.setState({\n            categorys\n          });\n        } else {\n          this.setState({\n            subCategorys: categorys\n          });\n        }\n      } else _message.error('失败');\n    };\n\n    this.showSubCategory = category => {\n      this.setState({\n        parentId: category._id,\n        parentName: category.name\n      }, () => {\n        this.getCategorys();\n      });\n    };\n\n    this.addCategory = async () => {\n      this.setState({\n        showStatus: 0\n      });\n      const parentId = this.classes.props.value;\n      const categoryName = this.input.props.value;\n\n      if (!categoryName) {\n        _message.error('名称不能为空!');\n\n        return;\n      }\n\n      const result = await reqAddCategory(categoryName, parentId);\n\n      if (result.status == 0) {\n        this.getCategorys();\n\n        _message.success('添加成功');\n      } else {\n        _message.error('添加失败');\n      }\n    };\n\n    this.updateCategory = async () => {\n      this.setState({\n        showStatus: 0\n      });\n      const categoryId = this.category._id;\n      const categoryName = this.form.state.value;\n\n      if (!categoryName) {\n        _message.error('名称不能为空!');\n\n        return;\n      }\n\n      const result = await reqUpdateCategory(categoryId, categoryName);\n\n      if (result.status === 200) {\n        this.getCategorys();\n\n        _message.success('修改成功');\n      } else {\n        _message.error('修改失败');\n      }\n    };\n\n    this.handleCancel = () => {\n      this.setState({\n        showStatus: 0\n      });\n    };\n  }\n\n  /* 准备数据 */\n  componentWillMount() {\n    this.initCategory();\n  }\n\n  componentDidMount() {\n    this.getCategorys();\n  }\n\n  render() {\n    const {\n      categorys,\n      subCategorys,\n      showStatus,\n      parentId,\n      parentName\n    } = this.state;\n    const category = this.category || {};\n    const title = parentId === \"0\" ? \"一级分类列表\" : /*#__PURE__*/_jsxDEV(_Space, {\n      children: [/*#__PURE__*/_jsxDEV(LinkButton, {\n        onClick: () => {\n          this.setState({\n            parentId: \"0\",\n            parentName: \"\",\n            subCategorys: []\n          }, () => {\n            this.getCategorys();\n          });\n        },\n        children: \"\\u4E00\\u7EA7\\u5206\\u7C7B\\u5217\\u8868\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }, this), \" \", parentName]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 13\n    }, this);\n\n    const extra = /*#__PURE__*/_jsxDEV(_Button, {\n      type: \"primary\",\n      icon: /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 23\n      }, this),\n      onClick: () => {\n        this.setState({\n          showStatus: 1\n        });\n      },\n      children: \"\\u6DFB\\u52A0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }, this);\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(_Card, {\n        title: title,\n        extra: extra,\n        style: {\n          marginTop: 0\n        },\n        children: [/*#__PURE__*/_jsxDEV(_Table, {\n          dataSource: parentId === \"0\" ? categorys : subCategorys,\n          columns: this.columns,\n          bordered: true,\n          rowKey: \"_id\",\n          loading: this.state.loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n          title: \"\\u6DFB\\u52A0\\u5206\\u7C7B\",\n          visible: showStatus === 1,\n          onOk: this.addCategory,\n          onCancel: this.handleCancel,\n          destroyOnClose: true,\n          children: /*#__PURE__*/_jsxDEV(AddForm, {\n            categorys: categorys,\n            categoryName: true,\n            setClasses: classes => {\n              this.classes = classes;\n            },\n            setInput: input => {\n              this.input = input;\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n          title: \"\\u66F4\\u65B0\\u5206\\u7C7B\",\n          visible: showStatus === 2,\n          onOk: this.updateCategory,\n          onCancel: this.handleCancel,\n          destroyOnClose: true,\n          children: /*#__PURE__*/_jsxDEV(UpdateForm, {\n            categoryName: category.name,\n            setForm: form => {\n              this.form = form;\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default _c = withRouter(Category);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["D:/Mark/RA/ws/react-admin/src/pages/category/category.jsx"],"names":["React","Component","useState","withRouter","PlusOutlined","LinkButton","reqCategorys","reqUpdateCategory","reqAddCategory","AddForm","UpdateForm","Category","state","loading","categorys","subCategorys","showStatus","parentId","parentName","initCategory","columns","title","dataIndex","key","width","render","category","setState","showSubCategory","getCategorys","result","status","data","error","_id","name","addCategory","classes","props","value","categoryName","input","success","updateCategory","categoryId","form","handleCancel","componentWillMount","componentDidMount","extra","marginTop"],"mappings":"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","sourcesContent":["import React, { Component, useState } from 'react'\r\nimport { withRouter } from 'react-router-dom';\r\nimport { Card, Table, Button, Form, message, Modal, Space } from 'antd'\r\nimport {\r\n    PlusOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport LinkButton from '../../components/link-button';\r\nimport { reqCategorys, reqUpdateCategory, reqAddCategory } from '../../api';\r\nimport AddForm from './add';\r\nimport UpdateForm from './update';\r\n\r\nclass Category extends Component {\r\n    state = {\r\n        loading: false,\r\n        categorys: [],\r\n        subCategorys: [],\r\n        showStatus: 0,\r\n        parentId: \"0\",\r\n        parentName: \"\",\r\n    };\r\n\r\n    initCategory = () => {\r\n        this.columns = [\r\n            {\r\n                title: '分类名称',\r\n                dataIndex: 'name',\r\n                key: 'name',\r\n            },\r\n            {\r\n                title: '操作',\r\n                dataIndex: '',\r\n                key: \"action\",\r\n                width: 200,\r\n\r\n                render: (category) => (\r\n                    <span>\r\n                        <LinkButton onClick={() => {\r\n                            this.category = category;\r\n                            this.setState({ showStatus: 2 });\r\n                        }}>\r\n                            修改\r\n                        </LinkButton>\r\n                        {\" \"}\r\n                        {this.state.parentId === \"0\" ? (\r\n                            <LinkButton\r\n                                onClick={() => {\r\n                                    this.showSubCategory(category);\r\n                                }}\r\n                            >\r\n                                查看子分类\r\n                            </LinkButton>\r\n                        ) : null}\r\n                    </span>\r\n                )\r\n            },\r\n\r\n        ]\r\n    };\r\n\r\n    /* 異物获取一级或者耳机分类列表显示 */\r\n    getCategorys = async () => {\r\n        this.setState({ loading: true })\r\n\r\n        const { parentId } = this.state;\r\n        const result = await reqCategorys(parentId);\r\n\r\n        this.setState({ loading: false });\r\n\r\n        if (result.status === 0) {\r\n            const categorys = result.data\r\n            if (parentId === \"0\") {\r\n                this.setState({ categorys });\r\n            } \r\n            else {\r\n                this.setState({ subCategorys: categorys });\r\n            }\r\n        }\r\n        else\r\n            message.error('失败')\r\n    };\r\n\r\n    /* 展现指定对象的子列表 */\r\n    showSubCategory = (category) => { \r\n        this.setState({\r\n            parentId: category._id,\r\n            parentName: category.name,\r\n        },\r\n        () => {\r\n            this.getCategorys();\r\n        });\r\n    };\r\n\r\n    addCategory = async () => {\r\n        this.setState({ showStatus: 0 });\r\n        const parentId = this.classes.props.value;\r\n        const categoryName = this.input.props.value;\r\n\r\n        if(!categoryName){\r\n            message.error('名称不能为空!')\r\n            return\r\n        }\r\n        const result = await reqAddCategory(categoryName, parentId);\r\n        if (result.status == 0) {\r\n            this.getCategorys();\r\n            message.success('添加成功')\r\n        }\r\n        else{\r\n            message.error('添加失败')\r\n        }\r\n    };\r\n\r\n    //修改后更新列表\r\n    updateCategory = async () => {\r\n        this.setState({ showStatus: 0 });\r\n\r\n        const categoryId = this.category._id;\r\n        const categoryName = this.form.state.value;\r\n        if(!categoryName){\r\n            message.error('名称不能为空!')\r\n            return\r\n        }\r\n      \r\n        const result = await reqUpdateCategory(categoryId, categoryName);\r\n      \r\n        if (result.status === 200) {\r\n            this.getCategorys();\r\n            message.success('修改成功')\r\n        }\r\n        else{\r\n            message.error('修改失败')\r\n        }\r\n    };\r\n\r\n    /* 准备数据 */\r\n    componentWillMount() {\r\n        this.initCategory();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getCategorys();\r\n    }\r\n  \r\n    handleCancel = () => {\r\n        this.setState({ showStatus: 0 });\r\n    };\r\n\r\n    render() {\r\n        const { \r\n            categorys,\r\n            subCategorys,\r\n            showStatus,\r\n            parentId,\r\n            parentName, \r\n        } = this.state\r\n\r\n        const category = this.category || {}\r\n\r\n        const title = parentId === \"0\" ? (\"一级分类列表\") : \r\n        (\r\n            <Space>\r\n                <LinkButton\r\n                    onClick={() => {\r\n                    this.setState({\r\n                        parentId: \"0\",\r\n                        parentName: \"\",\r\n                        subCategorys: [],\r\n                    },\r\n                    () => {\r\n                        this.getCategorys();\r\n                    });\r\n                    }}\r\n                >\r\n                    一级分类列表\r\n                </LinkButton>{\" \"}\r\n                {parentName}\r\n            </Space>\r\n        );\r\n\r\n        const extra = (\r\n            <Button \r\n                type=\"primary\" \r\n                icon={<PlusOutlined />} \r\n                onClick={() => {\r\n                    this.setState({ showStatus: 1 });\r\n                }}\r\n            >\r\n                添加\r\n            </Button>\r\n        )\r\n\r\n        return (\r\n            <div>\r\n                <Card title={title} extra={extra} style={{ marginTop: 0 }}>\r\n                    <Table\r\n                        dataSource={parentId === \"0\" ? categorys : subCategorys}\r\n                        columns={this.columns}\r\n                        bordered\r\n                        rowKey='_id'\r\n                        loading={this.state.loading}\r\n                    />\r\n\r\n                    <Modal\r\n                        title=\"添加分类\"\r\n                        visible={showStatus === 1}\r\n                        onOk={this.addCategory}\r\n                        onCancel={this.handleCancel}\r\n                        destroyOnClose={true}\r\n                    >\r\n                        <AddForm\r\n                            categorys={categorys}\r\n                            categoryName\r\n                            setClasses={(classes) => {\r\n                                this.classes = classes;\r\n                            }}\r\n                            setInput={(input) => {\r\n                                this.input = input;\r\n                            }}\r\n                        />\r\n                    </Modal>\r\n\r\n                    <Modal\r\n                        title=\"更新分类\"\r\n                        visible={showStatus === 2}\r\n                        onOk={this.updateCategory}\r\n                        onCancel={this.handleCancel}\r\n                        destroyOnClose={true}\r\n                    >\r\n                        <UpdateForm\r\n                            categoryName={category.name}\r\n                            setForm={(form) => { this.form = form }}\r\n                        />\r\n                    </Modal>\r\n                </Card>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default withRouter(Category);"]},"metadata":{},"sourceType":"module"}